<html>
<body>

Origin: <?php echo $_GET["org"]; ?><br>
Destination: <?php echo $_GET["dest"]; ?> <br>
Time: <?php echo $_GET["time"]; ?><br>

<?php
$addr = gethostbyname("localhost");
$client = stream_socket_client("tcp://$addr:5999", $errno, $errorMessage);

if ($client === false) {
    throw new UnexpectedValueException("Failed to connect: $errorMessage");
}

// $param=$_GET["org"].":".$_GET["dest"].":".$_GET["time"];
$param="test";
fwrite($client, $param);

$response=stream_get_contents($client,1024000);
// echo $response;
// $response="[{\"flights\": [{\"arrival\": \"2016-10-07T07:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T07:20-04:00\"}, {\"arrival\": \"2016-10-07T11:25-07:00\", \"to\": \"PDX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T09:05-05:00\"}, {\"arrival\": \"2016-10-07T14:00-07:00\", \"to\": \"SFO\", \"fr\": \"PDX\", \"depature\": \"2016-10-07T12:15-07:00\"}], \"total\": \"1. USD294.05\"}, {\"flights\": [{\"arrival\": \"2016-10-07T06:36-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T11:25-07:00\", \"to\": \"PDX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T09:05-05:00\"}, {\"arrival\": \"2016-10-07T14:00-07:00\", \"to\": \"SFO\", \"fr\": \"PDX\", \"depature\": \"2016-10-07T12:15-07:00\"}], \"total\": \"2. USD294.05\"}, {\"flights\": [{\"arrival\": \"2016-10-07T14:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T14:15-04:00\"}, {\"arrival\": \"2016-10-07T18:10-07:00\", \"to\": \"PDX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T15:50-05:00\"}, {\"arrival\": \"2016-10-07T20:24-07:00\", \"to\": \"SFO\", \"fr\": \"PDX\", \"depature\": \"2016-10-07T18:40-07:00\"}], \"total\": \"3. USD294.05\"}, {\"flights\": [{\"arrival\": \"2016-10-07T11:13-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T10:35-04:00\"}, {\"arrival\": \"2016-10-07T14:40-07:00\", \"to\": \"PDX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T12:20-05:00\"}, {\"arrival\": \"2016-10-07T18:42-07:00\", \"to\": \"SFO\", \"fr\": \"PDX\", \"depature\": \"2016-10-07T17:00-07:00\"}], \"total\": \"4. USD294.05\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T07:20-04:00\"}, {\"arrival\": \"2016-10-07T11:30-07:00\", \"to\": \"SEA\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T09:05-05:00\"}, {\"arrival\": \"2016-10-07T15:21-07:00\", \"to\": \"SFO\", \"fr\": \"SEA\", \"depature\": \"2016-10-07T13:20-07:00\"}], \"total\": \"5. USD309.90\"}, {\"flights\": [{\"arrival\": \"2016-10-07T06:36-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T11:30-07:00\", \"to\": \"SEA\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T09:05-05:00\"}, {\"arrival\": \"2016-10-07T14:19-07:00\", \"to\": \"SFO\", \"fr\": \"SEA\", \"depature\": \"2016-10-07T12:10-07:00\"}], \"total\": \"6. USD309.90\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T07:20-04:00\"}, {\"arrival\": \"2016-10-07T11:30-07:00\", \"to\": \"SEA\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T09:05-05:00\"}, {\"arrival\": \"2016-10-07T14:19-07:00\", \"to\": \"SFO\", \"fr\": \"SEA\", \"depature\": \"2016-10-07T12:10-07:00\"}], \"total\": \"7. USD309.90\"}, {\"flights\": [{\"arrival\": \"2016-10-07T10:21-06:00\", \"to\": \"DEN\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T08:33-04:00\"}, {\"arrival\": \"2016-10-07T13:00-07:00\", \"to\": \"LAX\", \"fr\": \"DEN\", \"depature\": \"2016-10-07T11:30-06:00\"}, {\"arrival\": \"2016-10-07T16:48-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T15:35-07:00\"}], \"total\": \"8. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T07:20-04:00\"}, {\"arrival\": \"2016-10-07T14:15-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T11:45-05:00\"}, {\"arrival\": \"2016-10-07T16:48-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T15:35-07:00\"}], \"total\": \"9. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T10:31-05:00\", \"to\": \"IAH\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T08:25-04:00\"}, {\"arrival\": \"2016-10-07T12:55-07:00\", \"to\": \"LAX\", \"fr\": \"IAH\", \"depature\": \"2016-10-07T11:30-05:00\"}, {\"arrival\": \"2016-10-07T16:48-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T15:35-07:00\"}], \"total\": \"10. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T18:07-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T17:36-04:00\"}, {\"arrival\": \"2016-10-07T21:32-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T19:10-05:00\"}, {\"arrival\": \"2016-10-07T23:49-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T22:30-07:00\"}], \"total\": \"11. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T06:36-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T10:05-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T07:30-05:00\"}, {\"arrival\": \"2016-10-07T14:11-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T13:00-07:00\"}], \"total\": \"12. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T06:36-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T10:05-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T07:30-05:00\"}, {\"arrival\": \"2016-10-07T12:24-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T11:00-07:00\"}], \"total\": \"13. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T13:55-05:00\", \"to\": \"IAH\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T11:50-04:00\"}, {\"arrival\": \"2016-10-07T15:54-07:00\", \"to\": \"LAX\", \"fr\": \"IAH\", \"depature\": \"2016-10-07T14:30-05:00\"}, {\"arrival\": \"2016-10-07T18:43-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T17:30-07:00\"}], \"total\": \"14. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:02-04:00\", \"to\": \"IAD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T10:09-07:00\", \"to\": \"LAX\", \"fr\": \"IAD\", \"depature\": \"2016-10-07T07:45-04:00\"}, {\"arrival\": \"2016-10-07T13:19-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T12:00-07:00\"}], \"total\": \"15. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T11:13-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T10:35-04:00\"}, {\"arrival\": \"2016-10-07T16:20-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T13:50-05:00\"}, {\"arrival\": \"2016-10-07T18:43-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T17:30-07:00\"}], \"total\": \"16. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T10:31-05:00\", \"to\": \"IAH\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T08:25-04:00\"}, {\"arrival\": \"2016-10-07T12:55-07:00\", \"to\": \"LAX\", \"fr\": \"IAH\", \"depature\": \"2016-10-07T11:30-05:00\"}, {\"arrival\": \"2016-10-07T15:55-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T14:37-07:00\"}], \"total\": \"17. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T08:06-05:00\", \"to\": \"IAH\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T10:59-07:00\", \"to\": \"LAX\", \"fr\": \"IAH\", \"depature\": \"2016-10-07T09:30-05:00\"}, {\"arrival\": \"2016-10-07T13:19-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T12:00-07:00\"}], \"total\": \"18. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T07:20-04:00\"}, {\"arrival\": \"2016-10-07T12:03-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T09:30-05:00\"}, {\"arrival\": \"2016-10-07T16:48-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T15:35-07:00\"}], \"total\": \"19. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T14:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T14:15-04:00\"}, {\"arrival\": \"2016-10-07T18:31-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T16:00-05:00\"}, {\"arrival\": \"2016-10-07T20:50-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T19:30-07:00\"}], \"total\": \"20. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:02-04:00\", \"to\": \"IAD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T11:09-07:00\", \"to\": \"LAX\", \"fr\": \"IAD\", \"depature\": \"2016-10-07T08:45-04:00\"}, {\"arrival\": \"2016-10-07T14:11-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T13:00-07:00\"}], \"total\": \"21. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T11:13-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T10:35-04:00\"}, {\"arrival\": \"2016-10-07T15:12-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T12:40-05:00\"}, {\"arrival\": \"2016-10-07T18:43-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T17:30-07:00\"}], \"total\": \"22. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T16:51-05:00\", \"to\": \"IAH\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T14:45-04:00\"}, {\"arrival\": \"2016-10-07T19:25-07:00\", \"to\": \"LAX\", \"fr\": \"IAH\", \"depature\": \"2016-10-07T18:00-05:00\"}, {\"arrival\": \"2016-10-07T21:45-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T20:30-07:00\"}], \"total\": \"23. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T11:13-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T10:35-04:00\"}, {\"arrival\": \"2016-10-07T15:12-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T12:40-05:00\"}, {\"arrival\": \"2016-10-07T19:43-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T18:30-07:00\"}], \"total\": \"24. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T13:55-05:00\", \"to\": \"IAH\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T11:50-04:00\"}, {\"arrival\": \"2016-10-07T16:57-07:00\", \"to\": \"LAX\", \"fr\": \"IAH\", \"depature\": \"2016-10-07T15:30-05:00\"}, {\"arrival\": \"2016-10-07T19:43-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T18:30-07:00\"}], \"total\": \"25. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:02-04:00\", \"to\": \"IAD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T06:00-04:00\"}, {\"arrival\": \"2016-10-07T11:09-07:00\", \"to\": \"LAX\", \"fr\": \"IAD\", \"depature\": \"2016-10-07T08:45-04:00\"}, {\"arrival\": \"2016-10-07T13:19-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T12:00-07:00\"}], \"total\": \"26. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T10:31-05:00\", \"to\": \"IAH\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T08:25-04:00\"}, {\"arrival\": \"2016-10-07T14:55-07:00\", \"to\": \"LAX\", \"fr\": \"IAH\", \"depature\": \"2016-10-07T13:30-05:00\"}, {\"arrival\": \"2016-10-07T16:48-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T15:35-07:00\"}], \"total\": \"27. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T10:21-06:00\", \"to\": \"DEN\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T08:33-04:00\"}, {\"arrival\": \"2016-10-07T13:00-07:00\", \"to\": \"LAX\", \"fr\": \"DEN\", \"depature\": \"2016-10-07T11:30-06:00\"}, {\"arrival\": \"2016-10-07T17:45-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T16:35-07:00\"}], \"total\": \"28. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T07:55-05:00\", \"to\": \"ORD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T07:20-04:00\"}, {\"arrival\": \"2016-10-07T13:18-07:00\", \"to\": \"LAX\", \"fr\": \"ORD\", \"depature\": \"2016-10-07T10:45-05:00\"}, {\"arrival\": \"2016-10-07T16:48-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T15:35-07:00\"}], \"total\": \"29. USD332.50\"}, {\"flights\": [{\"arrival\": \"2016-10-07T15:27-04:00\", \"to\": \"IAD\", \"fr\": \"PIT\", \"depature\": \"2016-10-07T14:15-04:00\"}, {\"arrival\": \"2016-10-07T19:09-07:00\", \"to\": \"LAX\", \"fr\": \"IAD\", \"depature\": \"2016-10-07T16:45-04:00\"}, {\"arrival\": \"2016-10-07T21:45-07:00\", \"to\": \"SFO\", \"fr\": \"LAX\", \"depature\": \"2016-10-07T20:30-07:00\"}], \"total\": \"30. USD332.50\"}]";
fclose($client);

$json_object=json_decode($response,true);
// var_dump($json_object);

foreach ($json_object as $p) {
	echo($p[total]);
	echo("<br>");
	foreach ($p[flights] as $f){
		echo($f[fr]);
		echo(" ");
		echo($f[depature]);
		echo(" ");
		echo($f[to]);
		echo(" ");	
		echo($f[arrival]);
		echo("<br>");
	}
}

?>

</body>
</html>